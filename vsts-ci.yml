name: PR-$(System.PullRequest.PullRequestNumber)-$(Date:yyyyMMdd)$(Rev:.rr)
resources:
- repo: self
  clean: true
phases:

- template: .vsts-ci/phase.yml
  parameters:
    name: ubuntu1604
    imagename: ubuntu16.04

- template: .vsts-ci/phase.yml
  parameters:
    name: ubuntu1404
    imagename: ubuntu14.04

- template: .vsts-ci/phase.yml
  parameters:
    name: ubuntu1804
    imagename: ubuntu18.04
    stable: false
    servicing: false

- template: .vsts-ci/phase.yml
  parameters:
    name: centos7
    imagename: centos7

- template: .vsts-ci/phase.yml
  parameters:
    name: fedora27
    imagename: fedora27

- template: .vsts-ci/phase.yml
  parameters:
    name: fedora28
    imagename: fedora28
    stable: false
    servicing: false

# Use CI switch to disable 1709 and 1803 builds because the VSTS hosted instances don't yet support 1709 or 1803
# Skipping previews on windows due to how long it takes to build on windows
- template: .vsts-ci/phase.yml
  parameters:
    name: nanoserver
    imagename: nanoserver
    servicing: false
    preview: false

- template: .vsts-ci/phase.yml
  parameters:
    name: windowsservercore
    imagename: windowsservercore
    servicing: false
    preview: false
